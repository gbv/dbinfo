[% 
    # TemplateToolkit template to create and serialize a JSON structure
    USE JSON.Escape( pretty => 1 ); 
    SET dbs = uri;

    data = {
        "@context" => "http://uri.gbv.de/database/dbinfo.jsonld",
        uri   => uri.str,
        title => {
            de => uri.dcterms_title('@de').str
        }
    };
    IF dbs.gbv_dbkey; data.dbkey = dbs.gbv_dbkey.str; END;
    SET en = uri.dcterms_title('@en').str;
    IF en; data.title.en = en; END;
    
    IF NOT dbs.type('skos:Concept');
        IF dbs.gbv_picabase; data.picabase = dbs.gbv_picabase.str; END;
        IF dbs.gbv_srubase; data.srubase = dbs.gbv_srubase.str; END;

        IF dbs.type('daiaserv:Openaccess');
            data.openaccess = JSON_TRUE;
        ELSE;
            data.openaccess = JSON_FALSE;
        END;

        SET org = dbs.rev('gbv:opac');
        IF org; data.opacOf = org.str; END;

        IF dbs.dcterms_extent; 
            data.count = 1*dbs.dcterms_extent.str; 
        END;
    END;

    IF dbs.foaf_homepage; data.url = dbs.foaf_homepage.str; END;
    IF dbs.foaf_isPrimaryTopicOf; data.infourl = dbs.foaf_isPrimaryTopicOf.str; END;

    data.json
%]
